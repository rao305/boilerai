<!DOCTYPE html>
<html>
<head>
    <title>Quick Login Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h2>üîß Quick Login Test</h2>
    <div id="results"></div>
    
    <script>
    async function runTests() {
        const results = document.getElementById('results');
        
        // Test 1: Check if backend is reachable
        try {
            results.innerHTML += `<div class="result">Testing backend connection...</div>`;
            const response = await fetch('http://localhost:5001/api/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: 'testdev@purdue.edu',
                    password: 'password123'
                })
            });
            
            if (response.ok) {
                const data = await response.json();
                results.innerHTML += `<div class="result success">‚úÖ Backend Connection: SUCCESS<br>Token: ${data.token?.substring(0, 30)}...</div>`;
            } else {
                results.innerHTML += `<div class="result error">‚ùå Backend Response Error: ${response.status}</div>`;
            }
        } catch (error) {
            results.innerHTML += `<div class="result error">‚ùå Backend Connection Failed: ${error.message}</div>`;
        }
        
        // Test 2: Test with environment variable URL
        try {
            results.innerHTML += `<div class="result">Testing with Vite API URL...</div>`;
            // This simulates what the frontend should use
            const apiUrl = 'http://localhost:5001/api'; // This is what VITE_API_URL should be
            const response = await fetch(`${apiUrl}/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: 'testdev@purdue.edu',
                    password: 'password123'
                })
            });
            
            if (response.ok) {
                const data = await response.json();
                results.innerHTML += `<div class="result success">‚úÖ API URL Test: SUCCESS<br>User: ${data.user?.name}</div>`;
            } else {
                results.innerHTML += `<div class="result error">‚ùå API URL Test Failed: ${response.status}</div>`;
            }
        } catch (error) {
            results.innerHTML += `<div class="result error">‚ùå API URL Test Error: ${error.message}</div>`;
        }
        
        results.innerHTML += `<div class="result success"><strong>üéâ If both tests show SUCCESS, the login should work now!</strong></div>`;
        results.innerHTML += `<div class="result">Go to: <a href="http://localhost:5173" target="_blank">http://localhost:5173</a></div>`;
    }
    
    runTests();
    </script>
</body>
</html>